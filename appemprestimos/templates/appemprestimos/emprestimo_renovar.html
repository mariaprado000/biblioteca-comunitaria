{% extends 'appdashboard/base.html' %}

{% block title %}Renovar Empréstimo{% endblock %}

{% block content %}
<div class='row justify-content-center'>
    <div class='col-md-6'>
        <div class='card'>
            <div class='card-header bg-primary text-white'>
                <h4><i class='fas fa-sync'></i> Renovar Empréstimo</h4>
            </div>
            <div class='card-body'>
                <h5>Informações do Empréstimo:</h5>
                <ul class='list-group mb-3'>
                    <li class='list-group-item'><strong>Livro:</strong> {{ emprestimo.livro.titulo }}</li>
                    <li class='list-group-item'><strong>Leitor:</strong> {{ emprestimo.leitor.usuario.get_full_name }}</li>
                    <li class='list-group-item'><strong>Data de Empréstimo:</strong> {{ emprestimo.data_emprestimo|date:'d/m/Y' }}</li>
                    <li class='list-group-item'><strong>Devolução Atual:</strong> {{ emprestimo.data_devolucao_prevista|date:'d/m/Y' }}</li>
                    <li class='list-group-item'><strong>Renovações já realizadas:</strong> {{ emprestimo.renovacoes }} de 2</li>
                </ul>
                
                {% if pode_renovar %}
                    <div class='alert alert-info' role='alert'>
                        <i class='fas fa-info-circle'></i> <strong>Atenção!</strong> 
                        Ao renovar, o prazo será estendido por mais 14 dias.
                    </div>
                    <form method='post'>
                        {% csrf_token %}
                        <button type='submit' class='btn btn-primary'>
                            <i class='fas fa-check'></i> Confirmar Renovação
                        </button>
                        <a href='{% url 'emprestimo_list' %}' class='btn btn-secondary'>
                            <i class='fas fa-times'></i> Cancelar
                        </a>
                    </form>
                {% else %}
                    <div class='alert alert-danger' role='alert'>
                        <i class='fas fa-exclamation-triangle'></i> <strong>Atenção!</strong> 
                        Este empréstimo não pode ser renovado. Possíveis motivos:
                        <ul class='mt-2'>
                            <li>O empréstimo está em atraso</li>
                            <li>Já foram feitas 2 renovações (limite máximo)</li>
                        </ul>
                    </div>
                    <a href='{% url 'emprestimo_list' %}' class='btn btn-secondary'>
                        <i class='fas fa-arrow-left'></i> Voltar
                    </a>
                {% endif %}
            </div>
        </div>
    </div>
</div>
{% endblock %}
